<!DOCTYPE html>
<html>
    <head>
	<title>Search Page</title>
	<script>
	    async function search(query) {
		try {
		    let response = await fetch("https://search-pl4q2xpkfq-uc.a.run.app/?query=" + query, {
			method: "GET"
		    });
		    return response;
		} catch(error) {
		    throw error;
		}
	    }

	    async function processSearch() {
		let query = document.getElementById("query").value;
		let button = document.getElementById("submit");
		let results = document.getElementById("results");
		button.disabled = true;
		results.innerHTML = "searching";
		try {
		    const response = await search(query);
		    console.log("gotten response");
		    let responseData = await response.json();
		    console.log(responseData);
		    resultText = "";
		    for(res of responseData) {
			resultText += "<a href='" + unescape(res.pageUrl) + "'><h3>" + res.pageTitle + "</h3></a><br>"
		    }
		    results.innerHTML = resultText;
		} catch(error) {
		    results.innerHTML = "Error: " + error.message;
		}
		button.disabled = false;
	    }
	</script>
    </head>

    <body>
	<label for="data">Search:</label>
	<input type="text" id="query" name="query"><br>
	<button id="submit" onclick="processSearch();">search</button>
	<br>
	<div id="results">Results will be displayed here</div>
    </body>
</html>
